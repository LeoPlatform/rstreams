---
title: "Running Locally"
date: 2018-12-29T11:02:05+06:00
weight: 2
draft: false
---

{{< collapse-light "ToC" >}}
{{< toc  >}}
{{</ collapse-light >}}

# Summary
This doc explains how to invoke bots running locally that hit actual queues in a deployed RStreams Bus as well as how to mock out
a queue and invoke a bot with that mock data.  It also explains how to set breakpoints in your code.

# Prerequisites
* This assumes you are using [Visual Studio Code](https://code.visualstudio.com/) as your IDE, however 
everything should be possible in your favorite IDE such as IntelliJ or whatever it may be
* If you want to follow along, you should go through the [Getting Started Guide](../getting-started)


# Things you need to know

#### Microservice Name / Service Name
Your project's microservice name, also just called the Service Name, is used in many places.  It's located in
`<project-root>/serverless.yml` near the top in the `service` attribute. Here, the project's service name is `rstreams-example`.
```yaml
service: rstreams-example
```

#### Bot
A bot is logical wrapper around code that executes to interact with an RStreams queue.  Bots are found in the `{project_dir}/bots/{bot_dir}`.  Each
bot has its own `serverless.yml` file.  Here's an example from the `weather-loader` bot of the RStreams Flow Example project.

{{< collapse-light "Example 1 code" true >}}
```yaml {linenos=inline,anchorlinenos=true,lineanchors=wlserverless}
weather-loader:
  name: ${self:service}-weather-loader
  handler: bots/weather-loader/index.handler
  description: Bot generated by serverless-leo
  memorySize: 256
  timeout: 300
  role: BotRole
  events:
    - leo:
        destination: rstreams-example.weather
        cron: 0 */1 * * * * 
        extra_data: 123
```
{{</ collapse-light >}}

#### Bot ID
Bots are referenced in config via their ID.  The ID is the first attribute in the bot's `serverless.yml` file that all other 
config is a child of.  In the above example it's on [Line 1](#wlserverless-1) and is named `weather-loader`.

#### Stage
Each RStreams Flow bot executes in the context of an environment, called a `stage`, such as dev/test/staging/prod.
The RStreams Flow example template project expects that your stage, the environment, is `dev` and that a file named `.env.dev` exists
that contains the name of the AWS secrets manager secret that contains the RStreams bus instance config to connect to.

#### RStreams Config
Each running RStreams SDK needs to know what resources to access that comprise the RStreams Bus instance you intend for it 
to read and write from/to.  This is called the RStreams Config.  The project has been setup such that the `dev` environment
is meant for running locally.  You should open up the `.env.dev` file and change the `RSTREAMS_CONFIG_SECRET` value to
be the name of the AWS Secrets Manager secret that was created when your RStreams Bus instance was installed.  It will
be named like this: `rstreams-{busName}` where `{busName}` is the name of your bus.  So, if you have a bus instanced
named `PlaygroundBus` your secret would be named `rstreams-PlaygroundBus`.  
[Jump here](../../rstreams-bus/getting-started/#how-do-you-access-the-new-rstreams-bus-instance) for lots more on this if you care.



```json
serverless invoke-bot --stage {environment} --function {bot-name}
```

RSTREAMS_CONFIG_SECRET="rstreams-us-west-2-clint-bus"

# Invoke a bot locally hitting an actual RStreams queue
{{< notice info >}}The invoke-bot startup performance was significantly improved in May 2022.{{</ notice >}}

```json
serverless invoke-bot --stage {environment} --function {bot-name}
```

* `serverless invoke-bot` : an RStreams plugin to serverless
* `--stage {environment}` : specifies the environment to run the bot within which will change the configuration used
* `--function {bot-name}` : the bot to invoke






serverless invoke-bot --stage dev --function weather-loader